from pycparser import parse_file
from c_vulnerability_scanner.utils import FAKE_LIBC_PATH




def parse(filename: str):
    fake_libc_option = "-I" + FAKE_LIBC_PATH.resolve().as_posix()
    ast = parse_file(
        filename,
        use_cpp=True,
        cpp_path="gcc",
        cpp_args=["-E", fake_libc_option],
    )
    ast.show()
